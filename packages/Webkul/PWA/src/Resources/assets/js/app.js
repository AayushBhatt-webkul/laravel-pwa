import Vue from"vue";import Toasted from"vue-toasted";import router from"./router";import App from"./components/app";import VueCurrencyFilter from"vue-currency-filter";import i18n from"./plugins/i18n";window.jQuery=window.$=require("jquery"),window.axios=require("axios"),window.VeeValidate=require("vee-validate"),window.EventBus=new Vue,Vue.prototype.$http=axios,axios.defaults.baseURL=window.config.app_base_url,require("./bootstrap"),Vue.use(VueCurrencyFilter,{symbol:"$",thousandsSeparator:",",fractionCount:2,fractionSeparator:".",symbolPosition:"front",symbolSpacing:!1}),Vue.use(VeeValidate),Vue.use(Toasted,{fullWidth:!0,fitToScreen:!0,closeOnSwipe:!1,duration:1e3}),Vue.use(require("vue-moment")),Vue.directive("sticky",require("./directives/sticky"));const app=new Vue({el:"#app",components:{App:App},i18n:i18n,created(){var e=this;axios.interceptors.response.use(function(r){if(!r.data.offline)return r;e.$router.push({name:"offline"})},this.errorResponseHandler)},methods:{errorResponseHandler(e){return EventBus.$emit("destroy-ajax-loader"),401!=e.response.status?(this.$toasted.show(e.response.data.error,{type:"error"}),Promise.reject(e)):this.$route.fullPath.includes("/account/")?(localStorage.removeItem("currentUser"),EventBus.$emit("user-logged-out"),this.$toasted.show(e.response.data.error,{type:"error"}),void this.$router.push({name:"login-register"})):Promise.reject(e)}},router:router});